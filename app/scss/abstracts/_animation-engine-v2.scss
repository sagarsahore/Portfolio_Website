/* VLT Animation Engine 2.0 - Mobile First CSS
   Ultra-fast, hardware-accelerated animations optimized for mobile */

// Animation variables optimized for mobile
$mobile-animation-duration: 0.3s;
$desktop-animation-duration: 0.5s;
$mobile-stagger-delay: 0.05s;
$desktop-stagger-delay: 0.1s;

// Performance-based animation durations
$high-performance-duration: 0.5s;
$medium-performance-duration: 0.3s;
$low-performance-duration: 0.2s;

// Easing functions optimized for mobile
$mobile-ease: cubic-bezier(0.25, 0.46, 0.45, 0.94); // Fast but smooth
$section-transition-ease: cubic-bezier(0.25, 0.46, 0.45, 0.94);
$element-ease: cubic-bezier(0.4, 0, 0.2, 1); // Material design

// Hardware acceleration mixin
@mixin hardware-acceleration-v2 {
    transform: translateZ(0);
    will-change: transform, opacity;
    backface-visibility: hidden;
    -webkit-backface-visibility: hidden;
    perspective: 1000px;
    -webkit-perspective: 1000px;
    transform-style: preserve-3d;
    -webkit-transform-style: preserve-3d;
}

// Mobile-optimized animation mixin
@mixin mobile-optimized-animation-v2($property: all, $duration: null, $easing: $mobile-ease) {
    @include hardware-acceleration-v2;
    
    // Default duration based on device
    @if $duration == null {
        transition: #{$property} $mobile-animation-duration $easing;
        
        @media (min-width: 768px) {
            transition: #{$property} $desktop-animation-duration $easing;
        }
    } @else {
        transition: #{$property} $duration $easing;
    }
}

// Performance-aware animation mixin
@mixin performance-animation($high-duration: $high-performance-duration, $medium-duration: $medium-performance-duration, $low-duration: $low-performance-duration) {
    // Default high performance
    animation-duration: $high-duration;
    
    // Medium performance
    .vlt-quality-medium & {
        animation-duration: $medium-duration;
    }
    
    // Low performance - simple fade only
    .vlt-quality-low & {
        animation: vlt_simple_fade $low-duration ease !important;
    }
}

// Section transition animations
@keyframes vlt_section_slide_up {
    from {
        transform: translateY(100%) translateZ(0);
        opacity: 0;
    }
    to {
        transform: translateY(0) translateZ(0);
        opacity: 1;
    }
}

@keyframes vlt_section_slide_down {
    from {
        transform: translateY(-100%) translateZ(0);
        opacity: 0;
    }
    to {
        transform: translateY(0) translateZ(0);
        opacity: 1;
    }
}

@keyframes vlt_section_slide_out_up {
    from {
        transform: translateY(0) translateZ(0);
        opacity: 1;
    }
    to {
        transform: translateY(-100%) translateZ(0);
        opacity: 0;
    }
}

@keyframes vlt_section_slide_out_down {
    from {
        transform: translateY(0) translateZ(0);
        opacity: 1;
    }
    to {
        transform: translateY(100%) translateZ(0);
        opacity: 0;
    }
}

// Ultra-fast mobile element animations
@keyframes vlt_mobile_fade_up {
    from {
        transform: translateY(20px) translateZ(0);
        opacity: 0;
    }
    to {
        transform: translateY(0) translateZ(0);
        opacity: 1;
    }
}

@keyframes vlt_mobile_fade_left {
    from {
        transform: translateX(-30px) translateZ(0);
        opacity: 0;
    }
    to {
        transform: translateX(0) translateZ(0);
        opacity: 1;
    }
}

@keyframes vlt_mobile_fade_right {
    from {
        transform: translateX(30px) translateZ(0);
        opacity: 0;
    }
    to {
        transform: translateX(0) translateZ(0);
        opacity: 1;
    }
}

@keyframes vlt_mobile_scale_in {
    from {
        transform: scale(0.8) translateZ(0);
        opacity: 0;
    }
    to {
        transform: scale(1) translateZ(0);
        opacity: 1;
    }
}

// Simple stable fade animations for content visibility
@keyframes vlt_stable_fade_in {
    from { 
        opacity: 0; 
    }
    to { 
        opacity: 1; 
    }
}

@keyframes vlt_stable_fade_out {
    from { 
        opacity: 1; 
    }
    to { 
        opacity: 0; 
    }
}

// Subtle fade in with minimal movement for stability
@keyframes vlt_subtle_fade_up {
    from {
        transform: translateY(10px) translateZ(0);
        opacity: 0;
    }
    to {
        transform: translateY(0) translateZ(0);
        opacity: 1;
    }
}

// Simple animations for low performance
@keyframes vlt_simple_fade {
    from { opacity: 0; }
    to { opacity: 1; }
}

// Desktop animations (more complex)
@keyframes vlt_desktop_slide_up {
    from {
        transform: translateY(50px) translateZ(0) rotateX(10deg);
        opacity: 0;
    }
    to {
        transform: translateY(0) translateZ(0) rotateX(0deg);
        opacity: 1;
    }
}

@keyframes vlt_desktop_slide_left {
    from {
        transform: translateX(-60px) translateZ(0) rotateY(5deg);
        opacity: 0;
    }
    to {
        transform: translateX(0) translateZ(0) rotateY(0deg);
        opacity: 1;
    }
}

// Section styles
.vlt-section {
    @include hardware-acceleration-v2;
    
    &.transitioning {
        @include mobile-optimized-animation-v2(transform opacity, $mobile-animation-duration);
    }
    
    &.active {
        transform: translateY(0) translateZ(0);
        opacity: 1;
    }
}

// Base animated block styles with stable fade focus
.vlt-animated-block {
    @include hardware-acceleration-v2;
    opacity: 0;
    transform: translateY(0) translateZ(0); // No initial transform for stability
    
    // Stable pre-animated state that maintains content readability
    &.vlt-stable-pre-animated {
        opacity: 0.3; // More visible than before for better content readability
        transform: translateY(0) translateZ(0);
        @include mobile-optimized-animation-v2(opacity, 0.3s);
    }
    
    // Pre-animated state for instant feedback (legacy support)
    &.vlt-pre-animated {
        opacity: 0.2;
        transform: translateY(5px) translateZ(0); // Reduced movement
        @include mobile-optimized-animation-v2(all, 0.3s);
    }
    
    // Instant show for above-fold content
    &.vlt-instant-show {
        opacity: 1;
        transform: translateY(0) translateZ(0);
    }
    
    // Stable fade animation - primary animation method
    &.vlt-stable-fade.animated {
        opacity: 1;
        transform: translateY(0) translateZ(0);
        animation: vlt_stable_fade_in 0.4s ease-out;
        
        @media (max-width: 767px) {
            animation: vlt_stable_fade_in 0.3s ease-out;
        }
    }
    
    // Subtle fade with minimal movement - alternative option
    &.vlt-subtle-fade.animated {
        opacity: 1;
        transform: translateY(0) translateZ(0);
        animation: vlt_subtle_fade_up 0.5s ease-out;
        
        @media (max-width: 767px) {
            animation: vlt_subtle_fade_up 0.3s ease-out;
        }
    }
    
    // Legacy animated state (for backward compatibility)
    &.animated:not(.vlt-stable-fade):not(.vlt-subtle-fade) {
        opacity: 1;
        transform: translateY(0) translateZ(0);
        
        // Use simple fade on mobile for better performance
        @media (max-width: 767px) {
            animation: vlt_stable_fade_in $mobile-animation-duration $mobile-ease;
        }
        
        // Use subtle fade on desktop
        @media (min-width: 768px) {
            animation: vlt_subtle_fade_up $desktop-animation-duration $element-ease;
        }
    }
    
    // Performance-based animation variants
    &.vlt-high-animation {
        @media (max-width: 767px) {
            animation: vlt_mobile_fade_up 0.3s $mobile-ease;
        }
        @media (min-width: 768px) {
            animation: vlt_desktop_slide_up 0.5s $element-ease;
        }
    }
    
    &.vlt-medium-animation {
        animation: vlt_mobile_fade_up 0.2s ease !important;
    }
    
    &.vlt-simple-animation {
        animation: vlt_simple_fade 0.15s ease !important;
    }
    
    // No animation fallback
    &.vlt-no-animation {
        animation: none !important;
        opacity: 1 !important;
        transform: translateY(0) translateZ(0) !important;
    }
}

// Direction-specific animations
.vlt-animated-block {
    // Fade in from left
    &.vlt-fade-left {
        @media (max-width: 767px) {
            &.animated { animation: vlt_mobile_fade_left $mobile-animation-duration $mobile-ease; }
        }
        @media (min-width: 768px) {
            &.animated { animation: vlt_desktop_slide_left $desktop-animation-duration $element-ease; }
        }
    }
    
    // Fade in from right
    &.vlt-fade-right {
        @media (max-width: 767px) {
            &.animated { animation: vlt_mobile_fade_right $mobile-animation-duration $mobile-ease; }
        }
        @media (min-width: 768px) {
            &.animated { animation: vlt_desktop_slide_left $desktop-animation-duration $element-ease reverse; }
        }
    }
    
    // Scale in animation
    &.vlt-scale-in {
        &.animated {
            animation: vlt_mobile_scale_in $mobile-animation-duration $mobile-ease;
            @include performance-animation(0.3s, 0.2s, 0.1s);
        }
    }
}

// Staggered animation delays
@for $i from 1 through 20 {
    .vlt-animated-block:nth-child(#{$i}) {
        animation-delay: #{($i - 1) * $mobile-stagger-delay};
        
        @media (min-width: 768px) {
            animation-delay: #{($i - 1) * $desktop-stagger-delay};
        }
        
        // Reduced delays for low performance
        .vlt-quality-low & {
            animation-delay: #{($i - 1) * 0.02s};
        }
    }
}

// Mobile device optimizations
.vlt-mobile-device {
    // Optimize touch interactions
    * {
        -webkit-tap-highlight-color: transparent;
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        user-select: none;
    }
    
    // Faster animations across the board
    .vlt-animated-block {
        animation-duration: $mobile-animation-duration !important;
    }
    
    // Reduce motion blur on scroll
    .vlt-section {
        -webkit-overflow-scrolling: touch;
    }
}

// Low performance device optimizations
.vlt-low-performance {
    // Disable complex transforms
    .vlt-animated-block {
        &.animated {
            animation: vlt_simple_fade 0.2s ease !important;
        }
    }
    
    // Simplified section transitions
    .vlt-section {
        &.transitioning {
            transition: opacity 0.2s ease !important;
        }
    }
}

// Reduced motion preferences
@media (prefers-reduced-motion: reduce) {
    .vlt-animated-block {
        &.animated {
            animation: vlt_simple_fade 0.2s ease !important;
        }
    }
    
    .vlt-section {
        &.transitioning {
            transition: opacity 0.3s ease !important;
        }
    }
    
    // Remove all transforms
    * {
        transform: none !important;
    }
}

// Battery saving mode
@media (prefers-reduced-motion: reduce), (prefers-color-scheme: dark) {
    .vlt-low-power-mode {
        .vlt-animated-block {
            animation: none !important;
            opacity: 1 !important;
        }
        
        .vlt-section {
            transition: none !important;
        }
    }
}

// Touch feedback
.vlt-touch-feedback {
    @include hardware-acceleration-v2;
    transition: transform 0.1s ease;
    
    &:active {
        transform: scale(0.98) translateZ(0);
    }
}

// Performance quality indicators
.vlt-quality-high {
    .vlt-performance-indicator::after {
        content: "High Performance";
        color: #4CAF50;
    }
}

.vlt-quality-medium {
    .vlt-performance-indicator::after {
        content: "Medium Performance";
        color: #FF9800;
    }
}

.vlt-quality-low {
    .vlt-performance-indicator::after {
        content: "Low Performance";
        color: #F44336;
    }
}

// Smooth section transitions for fullpage slider
.vlt-fullpage-slider {
    .vlt-section {
        @include hardware-acceleration-v2;
        transition: none; // Handled by JavaScript
        
        &.active {
            z-index: 2;
        }
        
        &.transitioning {
            z-index: 3;
        }
    }
}

// Animation cleanup utilities
.vlt-animation-complete {
    will-change: auto !important;
    transform: translateZ(0) !important; // Keep minimal acceleration for layout
}

// Preload animation styles
.vlt-preload-animation {
    @include hardware-acceleration-v2;
    opacity: 0;
    pointer-events: none;
}