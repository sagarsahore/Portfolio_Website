/* WIDGET: ANIMATED BLOCK - Engine 2.0 Enhanced
-------------------------------------------- */

// Import the new animation engine styles
@import '../abstracts/animation-engine-v2';

.vlt-animated-block {
	// Base state - optimized for instant feedback
	opacity: 0;
	transform: translateY(20px) translateZ(0);
	@include hardware-acceleration-v2;
	
	// Pre-animated state for instant visual feedback
	&.vlt-pre-animated {
		opacity: 0.1;
		transform: translateY(10px) translateZ(0);
		@include mobile-optimized-animation-v2(all, 0.3s);
	}
	
	// Instant show for above-fold content
	&.vlt-instant-show {
		opacity: 1;
		transform: translateY(0) translateZ(0);
		@include mobile-optimized-animation-v2(all, 0.2s);
	}

	// Animated state with performance adaptation
	&.animated {
		opacity: 1;
		transform: translateY(0) translateZ(0);
		
		// Default animation
		animation-name: vlt_animation_block_v2;
		animation-timing-function: $mobile-ease;
		animation-fill-mode: both;
		
		// Performance-based animation duration
		@include performance-animation(0.5s, 0.3s, 0.2s);
		
		// Mobile-specific optimizations
		@media (max-width: 767px) {
			animation-name: vlt_mobile_fade_up;
			animation-duration: $mobile-animation-duration;
		}
		
		// Desktop animations (more complex)
		@media (min-width: 768px) {
			animation-name: vlt_desktop_slide_up;
			animation-duration: $desktop-animation-duration;
		}
	}
	
	// Performance-aware animation variants
	&.vlt-high-animation {
		&.animated {
			@media (max-width: 767px) {
				animation: vlt_mobile_fade_up 0.3s $mobile-ease;
			}
			@media (min-width: 768px) {
				animation: vlt_desktop_slide_up 0.5s cubic-bezier(0.4, 0, 0.2, 1);
			}
		}
	}
	
	&.vlt-medium-animation {
		&.animated {
			animation: vlt_mobile_fade_up 0.2s ease !important;
		}
	}
	
	&.vlt-simple-animation {
		&.animated {
			animation: vlt_simple_fade 0.15s ease !important;
		}
	}
	
	// Mobile device optimizations
	.vlt-mobile-device & {
		// Hardware acceleration is critical on mobile
		@include hardware-acceleration-v2;
		
		&.animated {
			animation-duration: $mobile-animation-duration !important;
			animation-timing-function: $mobile-ease !important;
		}
		
		// Touch feedback
		&.vlt-touch-feedback:active {
			transform: scale(0.98) translateZ(0);
		}
	}
	
	// Low performance optimizations
	.vlt-low-performance &,
	.vlt-quality-low & {
		&.animated {
			animation: vlt_simple_fade 0.2s ease !important;
		}
	}
	
	// No animation fallback for accessibility
	&.vlt-no-animation {
		animation: none !important;
		opacity: 1 !important;
		transform: translateY(0) translateZ(0) !important;
		transition: none !important;
	}
	
	// Direction-specific animations
	&.vlt-fade-left {
		&.animated {
			@media (max-width: 767px) {
				animation: vlt_mobile_fade_left $mobile-animation-duration $mobile-ease;
			}
			@media (min-width: 768px) {
				animation: vlt_desktop_slide_left $desktop-animation-duration cubic-bezier(0.4, 0, 0.2, 1);
			}
		}
	}
	
	&.vlt-fade-right {
		&.animated {
			@media (max-width: 767px) {
				animation: vlt_mobile_fade_right $mobile-animation-duration $mobile-ease;
			}
			@media (min-width: 768px) {
				animation: vlt_desktop_slide_left $desktop-animation-duration cubic-bezier(0.4, 0, 0.2, 1) reverse;
			}
		}
	}
	
	&.vlt-scale-in {
		&.animated {
			animation: vlt_mobile_scale_in $mobile-animation-duration $mobile-ease;
			@include performance-animation(0.3s, 0.2s, 0.1s);
		}
	}
}

// Enhanced mobile keyframes
@keyframes vlt_animation_block_v2 {
	0% {
		transform: translateY(20px) translateZ(0);
		opacity: 0;
	}
	100% {
		transform: translateY(0) translateZ(0);
		opacity: 1;
	}
}

// Mobile-optimized complex animation for desktop
@media (min-width: 768px) {
	@keyframes vlt_animation_block_v2 {
		0% {
			transform: translateY(40px) translateZ(0) rotateX(5deg);
			opacity: 0;
		}
		100% {
			transform: translateY(0) translateZ(0) rotateX(0deg);
			opacity: 1;
		}
	}
}

// Staggered animation delays with mobile optimization
@for $i from 1 through 20 {
	.vlt-animated-block:nth-child(#{$i}) {
		// Mobile-optimized stagger timing
		animation-delay: #{($i - 1) * $mobile-stagger-delay};
		
		@media (min-width: 768px) {
			animation-delay: #{($i - 1) * $desktop-stagger-delay};
		}
		
		// Reduced delays for low performance
		.vlt-quality-low & {
			animation-delay: #{($i - 1) * 0.02s};
		}
		
		// No delay for reduced motion
		@media (prefers-reduced-motion: reduce) {
			animation-delay: 0s !important;
		}
	}
}

// Enhanced reduced motion support
@media (prefers-reduced-motion: reduce) {
	.vlt-animated-block {
		&.animated {
			animation: vlt_simple_fade 0.2s ease !important;
		}
		
		// Remove all transforms for reduced motion
		transform: none !important;
		
		&.vlt-pre-animated {
			opacity: 0.3;
			transform: none !important;
		}
	}
}

// Battery saving mode optimizations
@media (prefers-reduced-motion: reduce), (prefers-color-scheme: dark) {
	.vlt-low-power-mode .vlt-animated-block {
		&.animated {
			animation: none !important;
			opacity: 1 !important;
			transform: none !important;
		}
	}
}